<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Set Parameters</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  </head>
  <body>
  <div id="navbar"></div>
  
    <div class="container">
      <div class="row">
        <div style="padding-top: 12px;">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Set Parameters</h5>
              <div class="alert alert-primary" role="alert">
                <strong>Input minimum and maximum values wanted. Leave text field empty for default values!</strong>
              </div>              
              <form id="parametersForm">
              <div class="row">

                <div class="col-6">
                    <h5><u>Minimum</u></h5>
                    <div class="mb-3">
                        <label class="form-label">pH </label>
                        <input type="number" step="0.01" class="form-control" id="phMinimum" placeholder="0.00">
                        <div class="form-text">Example: 3.50</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Moisture  (%)</label>
                        <input type="number" step="0.01" class="form-control" id="moistureMinimum" placeholder="0.00">
                        <div class="form-text">Example: 25.10%</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Temperature  (째C)</label>
                        <input type="number" step="0.01" class="form-control" id="temperatureMinimum" placeholder="0.00">
                        <div class="form-text">Example: 28.20째C</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Conductivity  (uS/cm)</label>
                        <input type="number" step="0.01" class="form-control" id="conductivityMinimum" placeholder="0.00">
                        <div class="form-text">Example: 100.65 uS/cm</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Nitrogen  (mg/L)</label>
                        <input type="number" step="0.01" class="form-control" id="nitrogenMinimum" placeholder="0.00">
                        <div class="form-text">Example: 100.40 mg/L</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Phosphorus  (mg/L)</label>
                        <input type="number" step="0.01" class="form-control" id="phosphorusMinimum" placeholder="0.00">
                        <div class="form-text">Example: 100.40 mg/L</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Potassium  (mg/L)</label>
                        <input type="number" step="0.01" class="form-control" id="potassiumMinimum" placeholder="0.00">
                        <div class="form-text">Example: 100.40 mg/L</div>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit</button>
                </div>

                <div class="col-6">
                    <h5><u>Maximum</u></h5>
                    <div class="mb-3">
                        <label class="form-label">pH </label>
                        <input type="number" step="0.01" class="form-control" id="phMaximum" placeholder="0.00">
                        <div class="form-text">Example: 7.50</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Moisture  (%)</label>
                        <input type="number" step="0.01" class="form-control" id="moistureMaximum" placeholder="0.00">
                        <div class="form-text">Example: 50.65%</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Temperature  (째C)</label>
                        <input type="number" step="0.01" class="form-control" id="temperatureMaximum" placeholder="0.00">
                        <div class="form-text">Example: 32.50째C</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Conductivity  (uS/cm)</label>
                        <input type="number" step="0.01" class="form-control" id="conductivityMaximum" placeholder="0.00">
                        <div class="form-text">Example: 300.50 uS/cm</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Nitrogen  (mg/L)</label>
                        <input type="number" step="0.01" class="form-control" id="nitrogenMaximum" placeholder="0.00">
                        <div class="form-text">Example: 600.40 mg/L</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Phosphorus  (mg/L)</label>
                        <input type="number" step="0.01" class="form-control" id="phosphorusMaximum" placeholder="0.00">
                        <div class="form-text">Example: 600.40 mg/L</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Potassium  (mg/L)</label>
                        <input type="number" step="0.01" class="form-control" id="potassiumMaximum" placeholder="0.00">
                        <div class="form-text">Example: 600.40 mg/L</div>
                    </div>
                </div>

              </div>
            </form>
            </div>
          </div>
          </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="js/app.js"></script>
    <script>
      fetch('navbar.html')
        .then(response => response.text())
        .then(data => {
          document.getElementById('navbar').innerHTML = data;
        })
        .catch(error => console.error('Error loading navbar:', error));

        document.getElementById('parametersForm').addEventListener('submit', async function(e) {
          e.preventDefault();
          
            const parameterMinimum = {
              ph: parseFloat(document.getElementById('phMinimum').value),
              moisture: parseFloat(document.getElementById('moistureMinimum').value),
              temperature: parseFloat(document.getElementById('temperatureMinimum').value),
              conductivity: parseFloat(document.getElementById('conductivityMinimum').value),
              nitrogen: parseFloat(document.getElementById('nitrogenMinimum').value),
              phosphorus: parseFloat(document.getElementById('phosphorusMinimum').value),
              potassium: parseFloat(document.getElementById('potassiumMinimum').value)
            };

            const parameterMaximum = {
              ph: parseFloat(document.getElementById('phMaximum').value),
              moisture: parseFloat(document.getElementById('moistureMaximum').value),
              temperature: parseFloat(document.getElementById('temperatureMaximum').value),
              conductivity: parseFloat(document.getElementById('conductivityMaximum').value),
              nitrogen: parseFloat(document.getElementById('nitrogenMaximum').value),
              phosphorus: parseFloat(document.getElementById('phosphorusMaximum').value),
              potassium: parseFloat(document.getElementById('potassiumMaximum').value)
            };
 
          try {
                const response = await fetch('http://localhost:3000/setParameters', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({parameterMinimum, parameterMaximum})
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

            } catch (error) {
                console.error('Error setting parameters:', error);
                alert('Something went wrong. Failed to set parameters.');
            }
        });
    </script>
  </body>
</html>